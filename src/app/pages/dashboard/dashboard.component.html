<div class="row">
  <div class="col-xl-9">
    <nb-card>
      <nb-card-body>
        <div class="row">
          <div class="col-12 d-flex justify-content-end">
            <button *ngIf="!(isEditing | async)" nbButton ghost status="primary" size="small" (click)="enterEditMode()" nbTooltip="Edit draw"><nb-icon icon="edit"></nb-icon></button>
            <button *ngIf="isEditing | async" nbButton ghost status="success" size="small" (click)="addParticipant()" nbTooltip="Add participant"><nb-icon icon="plus"></nb-icon></button>
            <button *ngIf="isEditing | async" nbButton ghost status="primary" size="small" (click)="save()" nbTooltip="Save and generate"><nb-icon icon="save"></nb-icon></button>
            <button nbButton ghost status="primary" size="small" [disabled]="isEditing | async" (click)="generate()" nbTooltip="Regenerate draw"><nb-icon icon="repeat"></nb-icon></button>
          </div>
        </div>
        <nb-list>
          <nb-list-item *ngFor="let participant of participants">
            <div class="row">
              <div class="col-md-5">
                <button nbButton outline status="primary" disabled class="btn-with-icon" style="width: 100%; display: flex; justify-content: start">
                  <nb-user *ngIf="!(isEditing | async)" [name]="participant.name" [showTitle]="false" size="medium"></nb-user>
                  <input *ngIf="isEditing | async" type="text" nbInput placeholder="Participant name" [(ngModel)]="participant.name" style="max-width: 100%;" autofocus>
                </button>
                <button *ngIf="isEditing | async" nbButton ghost status="danger" size="small" (click)="removeParticipant(participant)" nbTooltip="Remove participant" class="position-absolute" style="right: 1em; top: 1em;"><nb-icon icon="trash"></nb-icon></button>
              </div>
              <div class="col-md-2 d-flex justify-content-center align-items-center">
                <nb-icon icon="arrow-forward-outline"></nb-icon>
              </div>
              <div class="col-md-5">
                <button nbButton outline status="primary" disabled class="btn-with-icon" style="width: 100%; display: flex; justify-content: start">
                  <nb-user [name]="participant.picked" [showTitle]="false" size="medium"></nb-user>
                </button>
              </div>
            </div>
          </nb-list-item>
        </nb-list>
        <div *ngIf="!hasEnoughParticipantsForDraw()" class="row d-flex justify-content-center">
          <div class="col-xl-6">
            <nb-alert outline="warning" class="mt-3 flex-row"><nb-icon icon="alert-triangle" status="warning"></nb-icon> <span> A draw requires at least 2 participants.</span></nb-alert>
          </div>
        </div>
      </nb-card-body>
    </nb-card>
  </div>

  <div class="col-xl-3">
    <nb-card>
      <nb-card-header>What is a secret santa?</nb-card-header>
      <nb-card-body>
        <blockquote cite="https://en.wikipedia.org/wiki/Secret_Santa">
          <p>Secret Santa is a Western Christmas tradition in which members of a group or community are randomly assigned a person to whom they give a gift. The identity of the gift giver is a secret not to be revealed until after the gift is opened.</p>
          <footer><cite><a href="https://en.wikipedia.org/wiki/Secret_Santa" target="_blank">Wikipedia</a></cite></footer>
        </blockquote>
      </nb-card-body>
    </nb-card>
    <nb-card>
      <nb-card-header>Why did I build this?</nb-card-header>
      <nb-card-body>
        I was in charge of organizing a draw for a secret santa in my family, so I used that opportunity to have fun while coding this small application. The application is open-source, which means that the full code can be found on <a href="https://github.com/dizco/secret-santa-generator" target="_blank">GitHub</a>.
      </nb-card-body>
    </nb-card>
  </div>
</div>
